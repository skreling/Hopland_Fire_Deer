---
title: "T-tests"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(openxlsx)
library(tidyverse)


`%notin%` <- negate(`%in%`)
```

In this script, we run statistical tests to compare differences in movement metrics among deer in and outside of the fire perimeter, and for deer before vs. after the fire.

# Displacement During Fire

Displacement distances were calculated in QGIS, based on MCP centroids as calculated in other scripts.
```{r}
# mean displacement during fire
table <- read.csv(here::here("Publication_Data","Collars","Distances_During_Fire_QGIS.csv"))

# split manually by whether or not deer were in fire, calculate mean and SD

# old code - incorrect, should have removed line 15: firedeer <- table[-c(2,7:8,14, 16),]

firedeer <- table %>% 
  filter(TargetID %notin% c("A5b", "H4", "H5", "J5", "K4"))
mean(firedeer$Distance)#avg = 1169.469, min = 42, max=4401
sd(firedeer$Distance)

nonfire <- table %>% 
  filter(TargetID %in% c("A5b", "H4", "H5", "J5", "K4"))
mean(nonfire$Distance) #253.57
sd(nonfire$Distance)

# not equal variances use welches t test
var.test(firedeer$Distance, nonfire$Distance)

t.test(firedeer$Distance, nonfire$Distance, var.equal = FALSE) #t = 2.9707, df = 12.636, p-value = 0.0111

```

# Movement Metrics

The movement metric summary spreadsheet was created manually based on teh results from the Collars1_Movement_Metrics.Rmd script.
```{r}
#Movement metrics
table <- read.xlsx(here::here("Publication_Data","Collars","summary_move_collars.xlsx"))

buck <- filter(table, AnimalID %in% c("H3", "P4"))

doe_all <- filter(table, AnimalID %notin% c("H3", "P4"))
doe_out <- filter(doe_all, AnimalID %in% c("A5b", "H4", "H5", "J5", "K4"))
doe_in <- filter(doe_all, AnimalID %notin% c("A5b", "H4", "H5", "J5", "K4"))

# old script:
doe <- table[c(2,3,6:9,11,12,13,16:17),]
doeOut <- table[c(1,4:5,10),]

#t=1.673, df=1, p=0.343, md=0.0226, sd=0.171
t.test(buck$TAC_Paired_Pre, buck$TAC_Paired_Post, paired=T)
#t=-0.54805, df=10, p=0.5957, md=-0.005, sd=0.0217
t.test(doe$TAC_Paired_Pre,doe$TAC_Paired_Post, paired = T)


t.test(doeOut$TAC_Paired_Pre, doeOut$TAC_Paired_Post, paired=T)
mean(doeOut$TAC_Paired_Pre)
sd(doeOut$TAC_Paired_Pre)
mean(doeOut$TAC_Paired_Post)
sd(doeOut$TAC_Paired_Post)

#Mean RT

#t=-2.5105, df=10, p-value=0.03089, md=-6.744238, sd=5.98567
t.test(doe$MeanRT_Paired_Pre, doe$MeanRT_Paired_Post, paired=T)
#t=0.87827, df=1, p=0.5412, md = 34.70273, sd = huge
t.test(buck$MeanRT_Paired_Pre, buck$MeanRT_Paired_Post, paired=T)


t.test(doeOut$MeanRT_Paired_Pre, doeOut$MeanRT_Paired_Post, paired=T)
mean(doeOut$MeanRT_Paired_Pre)
sd(doeOut$MeanRT_Paired_Pre)
mean(doeOut$MeanRT_Paired_Post)
sd(doeOut$MeanRT_Paired_Post)



#Mean T2R
#t=2.0221, df=10, p-value =0.07073, dif=8.593262,sd =9.468867
t.test(doe$MeanT2r_Paired_Pre, doe$MeanT2R_Paired_Post, paired=T)
#t=-1.1269, df=1, p=0.462, md=-9.598701, sd=huge
t.test(buck$MeanT2r_Paired_Pre, buck$MeanT2R_Paired_Post, paired=T)

t.test(doeOut$MeanT2r_Paired_Pre, doeOut$MeanT2R_Paired_Post, paired=T)
mean(doeOut$MeanT2r_Paired_Pre)
sd(doeOut$MeanT2r_Paired_Pre)
mean(doeOut$MeanT2R_Paired_Post)
sd(doeOut$MeanT2R_Paired_Post)


#speed hr

#t = -5.6776, df = 10, p-value = 0.0002045
t.test(doe$Mean_Dist_Hour_Paired_Pre, doe$Mean_Dist_Hour_Paired_Post, paired=T)
#t = -9.6911, df = 1, p-value = 0.06546
t.test(buck$Mean_Dist_Hour_Paired_Pre, buck$Mean_Dist_Hour_Paired_Post, paired=T)
#dist day
#t = -5.6776, df = 10, p-value = 0.0002045
t.test(doe$Mean_Dist_Day_Paired_Pre, doe$Mean_Dist_Day_Paired_Post, paired=T)


t.test(doeOut$Mean_Dist_Day_Paired_Pre, doeOut$Mean_Dist_Day_Paired_Post, paired=T)
t.test(doeOut$MeanT2r_Paired_Pre, doeOut$MeanT2R_Paired_Post, paired=T)
mean(doeOut$Mean_Dist_Day_Paired_Pre)
sd(doeOut$Mean_Dist_Day_Paired_Pre)
mean(doeOut$Mean_Dist_Day_Paired_Post)
sd(doeOut$Mean_Dist_Day_Paired_Post)

# straightness

straightness <- read.xlsx(here::here("Publication_Data","Collars","straightness_index.xlsx"))

straightness_buck <- filter(straightness, AnimalID %in% c("H3", "P4"))
straightness_doe <- filter(straightness, AnimalID %notin% c("H3", "P4"))

# All does
t.test(straightness_doe$Pre, straightness_doe$Post, paired=T)
t.test(straightness_buck$Pre, straightness_buck$Post, paired=T)
```
